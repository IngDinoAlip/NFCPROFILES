<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Contacto</title>
  <style>
    /* Reset básico */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
      width: 100%;
      height: 100%;
      font-family: Arial, sans-serif;
      background-color: #28a745; /* verde de fondo */
      color: #ffffff;
    }
    .container {
      max-width: 380px;
      margin: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .logos {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .logos img {
      height: 50px;
      width: auto;
    }
    .name-bar {
      background-color: rgba(255,255,255,0.2);
      padding: 10px 20px;
      border-radius: 20px;
      margin-bottom: 20px;
      font-size: 1.2rem;
      text-align: center;
      width: 100%;
    }
    .photo {
      width: 60%;
      max-width: 200px;
      aspect-ratio: 3/4; /* vertical rectangular */
      border-radius: 20px;
      overflow: hidden;
      margin-bottom: 20px;
    }
    .photo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .buttons {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .btn {
      background-color: rgba(255,255,255,0.3);
      color: #ffffff;
      text-decoration: none;
      padding: 12px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      transition: background-color 0.3s;
    }
    .btn:hover {
      background-color: rgba(255,255,255,0.5);
    }
    .btn .icon {
      width: 20px;
      height: 20px;
      margin-right: 8px;
      fill: #ffffff;
    }
    .contact-info {
      margin-top: 15px;
      text-align: center;
      font-size: 0.9rem;
      word-break: break-word;
    }
    @media (max-width: 400px) {
      .name-bar {
        font-size: 1rem;
      }
      .btn {
        padding: 10px;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logos">
      <img src="img/logo_ean.png" alt="Logo EAN">
      <img src="img/logo_facultad.png" alt="Logo Facultad">
    </div>
    <div class="name-bar" id="nameBar">Nombre</div>
    <div class="photo" id="photoContainer">
      <img src="" alt="Foto de perfil" id="photo">
    </div>
    <div class="buttons">
      <a href="#" target="_blank" id="linkedinBtn" class="btn">
        <!-- Puedes reemplazar con SVG o img icono LinkedIn -->
        <svg class="icon" viewBox="0 0 24 24"><path d="M4.98 3.5C3.34 3.5 2 4.84 2 6.5S3.34 9.5 4.98 9.5 7.96 8.16 7.96 6.5 6.62 3.5 4.98 3.5zM2.4 21h5.16V10.5H2.4V21zM9.6 10.5V21h5.16V15.3c0-3.3 4.32-3.6 4.32 0V21H24V13.5c0-6.54-7.44-6.3-9.6-3.09V10.5H9.6z"/></svg>
        LinkedIn
      </a>
      <a href="#" target="_blank" id="instagramBtn" class="btn">
        <svg class="icon" viewBox="0 0 24 24"><path d="M7 2C4.8 2 3 3.8 3 6v12c0 2.2 1.8 4 4 4h10c2.2 0 4-1.8 4-4V6c0-2.2-1.8-4-4-4H7zm5 5.6c2.42 0 4.4 1.98 4.4 4.4S14.42 16.4 12 16.4 7.6 14.42 7.6 12 9.58 7.6 12 7.6zm5.94-.44a1.03 1.03 0 1 1-2.06 0 1.03 1.03 0 0 1 2.06 0z"/></svg>
        Instagram
      </a>
      <a href="#" id="contactBtn" class="btn">
        <svg class="icon" viewBox="0 0 24 24"><path d="M21 8V7l-3 2-2-1-2 1-2-1-2 1-2-1-2 1-3-2v1l3 2 2-1 2 1 2-1 2 1 2-1 2 1z"/></svg>
        Contacto
      </a>
      <a href="#" id="vcardBtn" class="btn">
        <svg class="icon" viewBox="0 0 24 24"><path d="M20 2H8c-1.1 0-2 .9-2 2v4h2V4h12v16H8v-4H6v4c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM11 14l-3-3 1.41-1.41L11 11.17l4.59-4.59L17 8l-6 6z"/></svg>
        Guardar Contacto
      </a>
    </div>
    <div class="contact-info" id="contactInfo">
      <!-- Aquí se mostrará teléfono y correo si aplica -->
    </div>
  </div>

  <script>
    // ---- Configuración de perfiles ----
    // Cambia la ruta si mueves data.json
    const DATA_JSON = 'data.json';

    let profiles = {};
    let defaultProfile = {};

    // Función para obtener parámetro id de la URL
    function getParamId() {
      const params = new URLSearchParams(window.location.search);
      return params.get('id');
    }

    // Cargar JSON con los perfiles
    fetch(DATA_JSON)
      .then(response => response.json())
      .then(data => {
        profiles = data.profiles;
        defaultProfile = data.default;

        const id = getParamId();
        let profile = defaultProfile;
        if (id && profiles[id]) {
          profile = profiles[id];
        }

        populate(profile);
      })
      .catch(error => {
        console.error('Error cargando data.json:', error);
        // En caso de error, usar perfil por defecto si lo hay
        if (defaultProfile) populate(defaultProfile);
      });

    // Llenar la página con los datos del perfil
    function populate(profile) {
      document.getElementById('nameBar').innerText = profile.name;
      document.getElementById('photo').src = profile.photo;
      document.getElementById('photo').alt = 'Foto de ' + profile.name;

      // Botón LinkedIn
      const linkedinBtn = document.getElementById('linkedinBtn');
      linkedinBtn.href = profile.linkedin;

      // Botón Instagram
      const instagramBtn = document.getElementById('instagramBtn');
      instagramBtn.href = profile.instagram;

      // Botón Contacto
      const contactBtn = document.getElementById('contactBtn');
      // En móvil: número telefónico
      contactBtn.href = 'tel:' + profile.phone;
      // También mostrar correo abajo
      const ci = document.getElementById('contactInfo');
      ci.innerHTML = 'Tel: ' + profile.phone + '<br>Email: ' + profile.email;

      // Botón vCard
      const vcardBtn = document.getElementById('vcardBtn');
      vcardBtn.addEventListener('click', function(e) {
        e.preventDefault();
        downloadVCard(profile);
      });
    }

    // Generar y descargar archivo vCard (.vcf)
    function downloadVCard(profile) {
      const lines = [];
      lines.push('BEGIN:VCARD');
      lines.push('VERSION:3.0');
      lines.push('FN:' + profile.name);
      // No tengo nombre dividido; si lo tienes puedes separar N: apellido;nombre
      lines.push('TEL;TYPE=CELL:' + profile.phone);
      lines.push('EMAIL;TYPE=INTERNET:' + profile.email);
      lines.push('URL:' + profile.linkedin);
      lines.push('END:VCARD');

      const vcfContent = lines.join('\n');
      const blob = new Blob([vcfContent], { type: 'text/vcard;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      // Nombre del archivo: nombre perfil o "contact"
      const fileName = profile.name.replace(/\s+/g, '_').toLowerCase() + '.vcf';
      a.download = fileName;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    /* 
      Comentarios para mantenimiento:

      - Para añadir un nuevo perfil: abre data.json, agrega un nuevo objeto bajo "profiles" con clave ID que quieras (ej: "SH003"), y provee name, photo, linkedin, instagram, phone, email.

      - Las rutas de las imágenes: asegúrate de que las fotos estén en la carpeta `img/` (o donde prefieras), y en data.json el campo photo apunte correctamente, por ejemplo "img/foto_SH003.jpg".

    */
  </script>
</body>
</html>
